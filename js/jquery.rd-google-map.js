;(function($){'use strict'
var def_settings={cntClass:'map',mapClass:'map_model',locationsClass:'map_locations',marker:{basic:'images/gmap_marker.png',active:'images/gmap_marker_active.png'},styles:[{"elementType":"geometry","stylers":[{"hue":"#ff4400"},{"saturation":-68},{"lightness":-4},{"gamma":0.72}]},{"featureType":"road","elementType":"labels.icon"},{"featureType":"landscape.man_made","elementType":"geometry","stylers":[{"hue":"#0077ff"},{"gamma":3.1}]},{"featureType":"water","stylers":[{"hue":"#00ccff"},{"gamma":0.44},{"saturation":-33}]},{"featureType":"poi.park","stylers":[{"hue":"#44ff00"},{"saturation":-23}]},{"featureType":"water","elementType":"labels.text.fill","stylers":[{"hue":"#007fff"},{"gamma":0.77},{"saturation":65},{"lightness":99}]},{"featureType":"water","elementType":"labels.text.stroke","stylers":[{"gamma":0.11},{"weight":5.6},{"saturation":99},{"hue":"#0091ff"},{"lightness":-86}]},{"featureType":"transit.line","elementType":"geometry","stylers":[{"lightness":-48},{"hue":"#ff5e00"},{"gamma":1.2},{"saturation":-23}]},{"featureType":"transit","elementType":"labels.text.stroke","stylers":[{"saturation":-64},{"hue":"#ff9100"},{"lightness":16},{"gamma":0.47},{"weight":2.7}]}]},defaults={map:{x:-73.9924068,y:40.646197,zoom:14},locations:[]};var getLocations=function($map,settings){var $locations=$map.parent().find('.'+settings.locationsClass).find('li');var locations=[];if($locations.length>0){$locations.each(function(i){var $loc=$(this);if($loc.data('x')&&$loc.data('y')){locations[i]={x:$loc.data('x'),y:$loc.data('y'),basic:$loc.data('basic')?$loc.data('basic'):settings.marker.basic,active:$loc.data('active')?$loc.data('active'):settings.marker.active}
if(!$.trim($loc.html())){locations[i].content=false;}else{locations[i].content='<div class="iw-content">'+$loc.html()+'</div>';}}});}
return locations;}
$.fn.googleMap=function(settings){settings=$.extend(true,{},def_settings,settings);$(this).each(function(){var $this=$(this);var options=$.extend(true,{},defaults,{map:{x:$this.data('x'),y:$this.data('y'),zoom:$this.data('zoom')},locations:getLocations($this,settings)});var map=new google.maps.Map(this,{center:new google.maps.LatLng(parseFloat(options.map.y),parseFloat(options.map.x)),scrollwheel:false,styles:settings.styles,zoom:options.map.zoom}),infowindow=new google.maps.InfoWindow(),markers=[];for(var i in options.locations){markers[i]=new google.maps.Marker({position:new google.maps.LatLng(parseFloat(options.locations[i].y),parseFloat(options.locations[i].x)),map:map,icon:options.locations[i].basic,index:i});if(options.locations[i].content){google.maps.event.addListener(markers[i],'click',function(){for(var j in markers){markers[j].setIcon(options.locations[j].basic);}
infowindow.setContent(options.locations[this.index].content);infowindow.open(map,this);$('.gm-style-iw').parent().parent().addClass("gm-wrapper");this.setIcon(options.locations[this.index].active);});google.maps.event.addListener(infowindow,'closeclick',function(){for(var j in markers){markers[j].setIcon(options.locations[j].basic);}});}}
google.maps.event.addDomListener(window,'resize',function(){map.setCenter(new google.maps.LatLng(parseFloat(options.map.y),parseFloat(options.map.x)));});});};})(jQuery);